{
  "id": "mcp-FappZOihi5sU6cck",
  "name": "Hallucination Monitoring Dashboard",
  "description": "Converted from n8n workflow: Hallucination Monitoring Dashboard",
  "version": "1.0.0",
  "active": true,
  "nodes": [
    {
      "id": "209e6baa-2c9e-490d-836b-0e0d60884c5d",
      "name": "Schedule Trigger",
      "type": "mcp.unknown",
      "originalType": "n8n-nodes-base.scheduleTrigger",
      "position": [
        240,
        300
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 5
            }
          ]
        }
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Schedule Trigger"
      }
    },
    {
      "id": "b93046de-d6c3-4e6d-9f9f-4b65633ee6c8",
      "name": "Metrics Collection",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.function",
      "position": [
        460,
        300
      ],
      "parameters": {
        "functionCode": "// Collect hallucination monitoring data\nconst timestamp = new Date().toISOString();\n\n// Simulate system metrics collection\nconst systemMetrics = {\n  timestamp,\n  totalPrompts: Math.floor(Math.random() * 100) + 50,\n  hallucinationsDetected: Math.floor(Math.random() * 10) + 1,\n  correctionsApplied: Math.floor(Math.random() * 8) + 1,\n  averageProcessingTime: Math.floor(Math.random() * 5000) + 2000,\n  systemHealth: Math.random() * 0.4 + 0.6 // 60-100%\n};\n\n// Simulate crew member accuracy data\nconst crewMemberAccuracy = {\n  'Captain Picard': Math.random() * 0.2 + 0.8,\n  'Commander Data': Math.random() * 0.15 + 0.85,\n  'Counselor Troi': Math.random() * 0.25 + 0.75,\n  'Lieutenant Worf': Math.random() * 0.2 + 0.8,\n  'Commander Riker': Math.random() * 0.18 + 0.82,\n  'Lieutenant Commander La Forge': Math.random() * 0.15 + 0.85,\n  'Doctor Crusher': Math.random() * 0.22 + 0.78,\n  'Lieutenant Commander Tasha Yar': Math.random() * 0.2 + 0.8,\n  'Lieutenant Commander Spock': Math.random() * 0.12 + 0.88\n};\n\n// Simulate LLM performance data\nconst llmPerformance = {\n  'anthropic/claude-3-opus': Math.random() * 0.15 + 0.85,\n  'anthropic/claude-3-sonnet': Math.random() * 0.18 + 0.82,\n  'openai/gpt-4-turbo': Math.random() * 0.16 + 0.84,\n  'openai/gpt-4': Math.random() * 0.17 + 0.83,\n  'openai/gpt-3.5-turbo': Math.random() * 0.2 + 0.8\n};\n\n// Generate trend analysis\nconst trends = {\n  hallucinationRate: {\n    current: systemMetrics.hallucinationsDetected / systemMetrics.totalPrompts,\n    trend: Math.random() > 0.5 ? 'decreasing' : 'increasing',\n    change: Math.random() * 0.1 - 0.05 // -5% to +5%\n  },\n  systemHealth: {\n    current: systemMetrics.systemHealth,\n    trend: systemMetrics.systemHealth > 0.8 ? 'stable' : 'declining',\n    change: Math.random() * 0.05 - 0.025 // -2.5% to +2.5%\n  },\n  processingTime: {\n    current: systemMetrics.averageProcessingTime,\n    trend: systemMetrics.averageProcessingTime < 3000 ? 'improving' : 'degrading',\n    change: Math.random() * 500 - 250 // -250ms to +250ms\n  }\n};\n\n// Generate alerts\nconst alerts = [];\nif (systemMetrics.systemHealth < 0.7) {\n  alerts.push({\n    type: 'warning',\n    message: 'System health below 70%',\n    severity: 'medium'\n  });\n}\nif (systemMetrics.hallucinationsDetected / systemMetrics.totalPrompts > 0.15) {\n  alerts.push({\n    type: 'error',\n    message: 'Hallucination rate above 15%',\n    severity: 'high'\n  });\n}\nif (systemMetrics.averageProcessingTime > 10000) {\n  alerts.push({\n    type: 'warning',\n    message: 'Processing time above 10 seconds',\n    severity: 'medium'\n  });\n}\n\nreturn {\n  systemMetrics,\n  crewMemberAccuracy,\n  llmPerformance,\n  trends,\n  alerts,\n  timestamp,\n  monitoringPeriod: '5 minutes'\n};"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Metrics Collection"
      }
    },
    {
      "id": "45b59281-8193-4082-b6fb-70ab85711077",
      "name": "Alert Check",
      "type": "mcp.logic",
      "originalType": "n8n-nodes-base.if",
      "position": [
        680,
        300
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.alerts.length }}",
              "operation": "larger",
              "value2": "0"
            }
          ]
        }
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Alert Check"
      }
    },
    {
      "id": "0e81c697-980f-4090-8849-3c7970895427",
      "name": "Alert Processing",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.function",
      "position": [
        900,
        300
      ],
      "parameters": {
        "functionCode": "// Process alerts and generate notifications\nconst monitoringData = $input.first().json;\nconst alerts = monitoringData.alerts;\n\n// Generate alert notifications\nconst notifications = alerts.map(alert => ({\n  id: `alert_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n  type: alert.type,\n  severity: alert.severity,\n  message: alert.message,\n  timestamp: monitoringData.timestamp,\n  systemHealth: monitoringData.systemMetrics.systemHealth,\n  recommendedActions: generateRecommendedActions(alert)\n}));\n\nfunction generateRecommendedActions(alert) {\n  switch (alert.type) {\n    case 'warning':\n      return [\n        'Review system configuration',\n        'Check crew member performance',\n        'Monitor for additional issues'\n      ];\n    case 'error':\n      return [\n        'Immediate investigation required',\n        'Review hallucination detection thresholds',\n        'Consider system restart if persistent',\n        'Escalate to system administrator'\n      ];\n    default:\n      return ['Monitor system closely'];\n  }\n}\n\nreturn {\n  ...monitoringData,\n  notifications,\n  alertCount: alerts.length\n};"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Alert Processing"
      }
    },
    {
      "id": "b8898ebb-e3b5-4f81-aa10-0a7331adf7a7",
      "name": "Dashboard Generation",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.function",
      "position": [
        1120,
        300
      ],
      "parameters": {
        "functionCode": "// Generate monitoring dashboard data\nconst monitoringData = $input.first().json;\n\n// Format dashboard data\nconst dashboardData = {\n  timestamp: monitoringData.timestamp,\n  summary: {\n    systemHealth: Math.round(monitoringData.systemMetrics.systemHealth * 100),\n    totalPrompts: monitoringData.systemMetrics.totalPrompts,\n    hallucinationRate: Math.round((monitoringData.systemMetrics.hallucinationsDetected / monitoringData.systemMetrics.totalPrompts) * 100),\n    correctionsApplied: monitoringData.systemMetrics.correctionsApplied,\n    averageProcessingTime: monitoringData.systemMetrics.averageProcessingTime\n  },\n  trends: monitoringData.trends,\n  alerts: monitoringData.alerts || [],\n  notifications: monitoringData.notifications || [],\n  crewPerformance: Object.entries(monitoringData.crewMemberAccuracy).map(([member, accuracy]) => ({\n    crewMember: member,\n    accuracy: Math.round(accuracy * 100),\n    status: accuracy > 0.8 ? 'excellent' : accuracy > 0.7 ? 'good' : 'needs_attention'\n  })),\n  llmPerformance: Object.entries(monitoringData.llmPerformance).map(([llm, performance]) => ({\n    llm,\n    performance: Math.round(performance * 100),\n    status: performance > 0.85 ? 'optimal' : performance > 0.8 ? 'good' : 'needs_optimization'\n  })),\n  recommendations: generateRecommendations(monitoringData)\n};\n\nfunction generateRecommendations(data) {\n  const recommendations = [];\n  \n  if (data.systemMetrics.systemHealth < 0.8) {\n    recommendations.push({\n      type: 'system_health',\n      priority: 'high',\n      message: 'System health is below optimal. Consider reviewing hallucination detection thresholds.'\n    });\n  }\n  \n  if (data.systemMetrics.averageProcessingTime > 5000) {\n    recommendations.push({\n      type: 'performance',\n      priority: 'medium',\n      message: 'Processing time is high. Consider optimizing LLM selection or reducing crew size.'\n    });\n  }\n  \n  const lowAccuracyCrew = Object.entries(data.crewMemberAccuracy)\n    .filter(([_, accuracy]) => accuracy < 0.8)\n    .map(([member, _]) => member);\n  \n  if (lowAccuracyCrew.length > 0) {\n    recommendations.push({\n      type: 'crew_training',\n      priority: 'medium',\n      message: `Crew members with low accuracy: ${lowAccuracyCrew.join(', ')}. Consider additional training.`\n    });\n  }\n  \n  return recommendations;\n}\n\nreturn dashboardData;"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Dashboard Generation"
      }
    },
    {
      "id": "b5554a8d-6d7f-45aa-b4d4-dcf1de3594c0",
      "name": "Database Storage",
      "type": "mcp.database",
      "originalType": "n8n-nodes-base.supabase",
      "position": [
        1340,
        300
      ],
      "parameters": {
        "operation": "insert",
        "table": "hallucination_monitoring",
        "columns": "timestamp, system_health, total_prompts, hallucination_rate, corrections_applied, processing_time, alerts_count, recommendations_count",
        "values": "={{ $json.timestamp }}, {{ $json.summary.systemHealth }}, {{ $json.summary.totalPrompts }}, {{ $json.summary.hallucinationRate }}, {{ $json.summary.correctionsApplied }}, {{ $json.summary.averageProcessingTime }}, {{ $json.alerts.length }}, {{ $json.recommendations.length }}"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Database Storage"
      }
    },
    {
      "id": "a5a33cb5-e108-48fd-8594-2ac2983506ca",
      "name": "Monitoring Log",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.function",
      "position": [
        1560,
        300
      ],
      "parameters": {
        "functionCode": "// Log monitoring results\nconst dashboardData = $input.first().json;\n\nconsole.log('ðŸ›¡ï¸ Anti-Hallucination Monitoring Dashboard');\nconsole.log('==========================================');\nconsole.log(`ðŸ“Š System Health: ${dashboardData.summary.systemHealth}%`);\nconsole.log(`ðŸ“ Total Prompts: ${dashboardData.summary.totalPrompts}`);\nconsole.log(`ðŸš¨ Hallucination Rate: ${dashboardData.summary.hallucinationRate}%`);\nconsole.log(`ðŸ”§ Corrections Applied: ${dashboardData.summary.correctionsApplied}`);\nconsole.log(`â±ï¸  Average Processing Time: ${dashboardData.summary.averageProcessingTime}ms`);\n\nif (dashboardData.alerts.length > 0) {\n  console.log('\\nâš ï¸  Active Alerts:');\n  dashboardData.alerts.forEach(alert => {\n    console.log(`  ${alert.type.toUpperCase()}: ${alert.message}`);\n  });\n}\n\nif (dashboardData.recommendations.length > 0) {\n  console.log('\\nðŸ’¡ Recommendations:');\n  dashboardData.recommendations.forEach(rec => {\n    console.log(`  [${rec.priority.toUpperCase()}] ${rec.message}`);\n  });\n}\n\nconsole.log('\\nðŸ‘¥ Crew Performance:');\ndashboardData.crewPerformance.forEach(crew => {\n  console.log(`  ${crew.crewMember}: ${crew.accuracy}% (${crew.status})`);\n});\n\nconsole.log('\\nðŸ¤– LLM Performance:');\ndashboardData.llmPerformance.forEach(llm => {\n  console.log(`  ${llm.llm}: ${llm.performance}% (${llm.status})`);\n});\n\nreturn {\n  ...dashboardData,\n  loggedAt: new Date().toISOString(),\n  logLevel: 'INFO'\n};"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Monitoring Log"
      }
    },
    {
      "id": "e30a5cbb-0f54-47f7-9d1a-e204921670b6",
      "name": "No Alerts",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.function",
      "position": [
        900,
        500
      ],
      "parameters": {
        "functionCode": "// Skip alert processing when no alerts\nconst monitoringData = $input.first().json;\n\nreturn {\n  ...monitoringData,\n  alertCount: 0,\n  notifications: [],\n  message: 'No alerts to process'\n};"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "No Alerts"
      }
    }
  ],
  "edges": [
    {
      "id": "edge-Schedule Trigger-Metrics Collection",
      "source": "Schedule Trigger",
      "target": "Metrics Collection",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Metrics Collection-Alert Check",
      "source": "Metrics Collection",
      "target": "Alert Check",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Alert Check-Alert Processing",
      "source": "Alert Check",
      "target": "Alert Processing",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Alert Check-No Alerts",
      "source": "Alert Check",
      "target": "No Alerts",
      "sourceHandle": "main-1",
      "targetHandle": "input"
    },
    {
      "id": "edge-Alert Processing-Dashboard Generation",
      "source": "Alert Processing",
      "target": "Dashboard Generation",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-No Alerts-Dashboard Generation",
      "source": "No Alerts",
      "target": "Dashboard Generation",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Dashboard Generation-Database Storage",
      "source": "Dashboard Generation",
      "target": "Database Storage",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Database Storage-Monitoring Log",
      "source": "Database Storage",
      "target": "Monitoring Log",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    }
  ],
  "webhookExecutionPoints": [],
  "metadata": {
    "originalWorkflowId": "FappZOihi5sU6cck",
    "convertedAt": "2025-11-21T14:24:04.670Z",
    "originalName": "Hallucination Monitoring Dashboard"
  }
}