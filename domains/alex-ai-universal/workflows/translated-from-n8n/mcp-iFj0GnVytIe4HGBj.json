{
  "id": "mcp-iFj0GnVytIe4HGBj",
  "name": "Project Content Store",
  "description": "Converted from n8n workflow: Project Content Store",
  "version": "1.0.0",
  "active": true,
  "nodes": [
    {
      "id": "931bb939-2afd-416c-aeee-3f95678f9357",
      "name": "Webhook Trigger",
      "type": "mcp.webhook",
      "originalType": "n8n-nodes-base.webhook",
      "position": [
        250,
        300
      ],
      "parameters": {
        "path": "project-content-store",
        "responseMode": "responseNode",
        "options": {}
      },
      "webhookInfo": {
        "path": "project-content-store",
        "method": "POST",
        "responseMode": "responseNode",
        "note": "⚠️ WEBHOOK EXECUTION POINT: This webhook can be executed via MCP at /api/workflows/execute with webhook path"
      },
      "metadata": {
        "converted": true,
        "originalNode": "Webhook Trigger"
      }
    },
    {
      "id": "b7f290b9-10d8-4539-81ed-68118aa18017",
      "name": "Validate Input",
      "type": "mcp.logic",
      "originalType": "n8n-nodes-base.if",
      "position": [
        450,
        300
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.body.projectId}}",
              "operation": "isNotEmpty"
            },
            {
              "value1": "={{$json.body.headline}}",
              "operation": "isNotEmpty"
            },
            {
              "value1": "={{$json.headers['x-source']}}",
              "value2": "alex-ai-dashboard"
            }
          ]
        }
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Validate Input"
      }
    },
    {
      "id": "a1dd2f56-c704-4e9a-9fae-e2fed9414a72",
      "name": "Supabase Upsert",
      "type": "mcp.database",
      "originalType": "n8n-nodes-base.postgres",
      "position": [
        650,
        200
      ],
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO project_content (project_id, headline, subheadline, description, theme, business_type, components, pages, updated_at, version)\nVALUES ($1, $2, $3, $4, $5, $6, $7::jsonb, $8::jsonb, $9, COALESCE((SELECT version FROM project_content WHERE project_id = $1), 0) + 1)\nON CONFLICT (project_id) DO UPDATE SET\n  headline = EXCLUDED.headline,\n  subheadline = EXCLUDED.subheadline,\n  description = EXCLUDED.description,\n  theme = EXCLUDED.theme,\n  business_type = EXCLUDED.business_type,\n  components = EXCLUDED.components,\n  pages = EXCLUDED.pages,\n  updated_at = EXCLUDED.updated_at\nRETURNING *;",
        "parameters": {
          "values": [
            {
              "name": "$1",
              "value": "={{$json.body.projectId}}"
            },
            {
              "name": "$2",
              "value": "={{$json.body.headline}}"
            },
            {
              "name": "$3",
              "value": "={{$json.body.subheadline || ''}}"
            },
            {
              "name": "$4",
              "value": "={{$json.body.description || ''}}"
            },
            {
              "name": "$5",
              "value": "={{$json.body.theme || 'gradient'}}"
            },
            {
              "name": "$6",
              "value": "={{$json.body.businessType || null}}"
            },
            {
              "name": "$7",
              "value": "={{JSON.stringify($json.body.components || [])}}"
            },
            {
              "name": "$8",
              "value": "={{JSON.stringify($json.body.pages || {})}}"
            },
            {
              "name": "$9",
              "value": "={{$json.body.updatedAt}}"
            }
          ]
        }
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Supabase Upsert"
      }
    },
    {
      "id": "9bbe3dbc-b653-4421-aca5-ad0b7e84e9c2",
      "name": "Response Success",
      "type": "mcp.response",
      "originalType": "n8n-nodes-base.respondToWebhook",
      "position": [
        850,
        200
      ],
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ { \"success\": true, \"projectId\": $json.project_id, \"version\": $json.version, \"syncedAt\": $json.synced_at } }}"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Response Success"
      }
    },
    {
      "id": "e9d2bb26-1e03-4cc5-b7bf-c620da791c83",
      "name": "Response Error",
      "type": "mcp.response",
      "originalType": "n8n-nodes-base.respondToWebhook",
      "position": [
        650,
        400
      ],
      "parameters": {
        "respondWith": "json",
        "responseCode": 400,
        "responseBody": "={{ { \"success\": false, \"error\": \"Invalid input: missing required fields\" } }}"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Response Error"
      }
    }
  ],
  "edges": [
    {
      "id": "edge-Webhook Trigger-Validate Input",
      "source": "Webhook Trigger",
      "target": "Validate Input",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Validate Input-Supabase Upsert",
      "source": "Validate Input",
      "target": "Supabase Upsert",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Validate Input-Response Error",
      "source": "Validate Input",
      "target": "Response Error",
      "sourceHandle": "main-1",
      "targetHandle": "input"
    },
    {
      "id": "edge-Supabase Upsert-Response Success",
      "source": "Supabase Upsert",
      "target": "Response Success",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    }
  ],
  "webhookExecutionPoints": [
    {
      "nodeId": "931bb939-2afd-416c-aeee-3f95678f9357",
      "nodeName": "Webhook Trigger",
      "webhookPath": "project-content-store",
      "webhookMethod": "POST",
      "mcpExecutionPath": "/api/workflows/execute?webhook=project-content-store",
      "note": "⚠️ WEBHOOK EXECUTION POINT: This webhook can be executed via MCP at /api/workflows/execute with webhook path"
    }
  ],
  "metadata": {
    "originalWorkflowId": "iFj0GnVytIe4HGBj",
    "convertedAt": "2025-11-21T14:24:04.681Z",
    "originalName": "Project Content Store"
  }
}