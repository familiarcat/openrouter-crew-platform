{
  "id": "mcp-vcuWBVUzAADZ8e5r",
  "name": "COORDINATION - Observation Lounge - OpenRouter - Production",
  "description": "Converted from n8n workflow: COORDINATION - Observation Lounge - OpenRouter - Production",
  "version": "1.0.0",
  "active": true,
  "nodes": [
    {
      "id": "fa6bfef2-ec35-4667-94c1-eab105c24379",
      "name": "Observation Lounge Trigger",
      "type": "mcp.webhook",
      "originalType": "n8n-nodes-base.webhook",
      "position": [
        240,
        304
      ],
      "parameters": {
        "httpMethod": "POST",
        "path": "observation-lounge",
        "responseMode": "responseNode",
        "options": {}
      },
      "webhookInfo": {
        "path": "observation-lounge",
        "method": "POST",
        "responseMode": "responseNode",
        "note": "‚ö†Ô∏è WEBHOOK EXECUTION POINT: This webhook can be executed via MCP at /api/workflows/execute with webhook path"
      },
      "metadata": {
        "converted": true,
        "originalNode": "Observation Lounge Trigger"
      }
    },
    {
      "id": "1fa38a22-0b34-4457-9d9a-4cfec5d00701",
      "name": "Session Validator & Coordinator",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.code",
      "position": [
        464,
        304
      ],
      "parameters": {
        "jsCode": "// Validate and prepare Observation Lounge session\nconst inputData = $input.all()[0].json;\n\n// Validate required fields\nif (!inputData.topic) {\n  throw new Error('topic is required for Observation Lounge session');\n}\n\n// Extract session parameters\nconst topic = inputData.topic;\nconst context = inputData.context || {};\nconst crew_members = inputData.crew_members || 'all';\nconst discussion_type = inputData.discussion_type || 'collaborative';\nconst priority = inputData.priority || 'medium';\n\n// Prepare enhanced session data\nreturn {\n  session_id: `ol_${Date.now()}`,\n  topic: topic,\n  context: context,\n  crew_members: crew_members,\n  discussion_type: discussion_type,\n  priority: priority,\n  timestamp: new Date().toISOString(),\n  session_status: 'initialized',\n  \n  // Discussion framework\n  framework: {\n    objective: 'Collaborative crew decision-making',\n    format: 'Structured department perspectives',\n    output: 'Synthesized recommendations and action plan'\n  },\n  \n  // Crew coordination parameters\n  coordination: {\n    max_response_time: 30000, // 30 seconds\n    require_all_departments: true,\n    enable_synthesis: true,\n    enable_recommendations: true\n  }\n};"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Session Validator & Coordinator"
      }
    },
    {
      "id": "4dbf85b6-0f88-4509-b60e-53ef1308e576",
      "name": "Crew Routing & Coordination Engine",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.code",
      "position": [
        688,
        304
      ],
      "parameters": {
        "jsCode": "// Route to appropriate crew coordination method\nconst sessionData = $input.all()[0].json;\nconst { discussion_type, crew_members, priority } = sessionData;\n\n// Determine routing strategy\nlet routing_strategy = 'full_crew';\nlet crew_selection = 'all';\nlet coordination_method = 'observation_lounge';\n\nif (discussion_type === 'department_specific') {\n  routing_strategy = 'department_focused';\n  crew_selection = crew_members;\n  coordination_method = 'department_meeting';\n} else if (discussion_type === 'executive') {\n  routing_strategy = 'command_focused';\n  crew_selection = ['captain_picard', 'commander_riker', 'commander_data'];\n  coordination_method = 'command_briefing';\n} else if (discussion_type === 'technical') {\n  routing_strategy = 'technical_focused';\n  crew_selection = ['geordi_la_forge', 'commander_data', 'lieutenant_worf'];\n  coordination_method = 'technical_review';\n} else if (discussion_type === 'strategic') {\n  routing_strategy = 'strategic_focused';\n  crew_selection = ['captain_picard', 'commander_data', 'counselor_troi', 'quark'];\n  coordination_method = 'strategic_planning';\n}\n\n// Priority-based adjustments\nif (priority === 'high') {\n  coordination_method += '_urgent';\n} else if (priority === 'low') {\n  coordination_method += '_standard';\n}\n\nreturn {\n  ...sessionData,\n  routing_strategy: routing_strategy,\n  crew_selection: crew_selection,\n  coordination_method: coordination_method,\n  \n  // Enhanced coordination parameters\n  coordination_enhanced: {\n    method: coordination_method,\n    crew_count: Array.isArray(crew_selection) ? crew_selection.length : 'all',\n    expected_duration: priority === 'high' ? 'fast' : 'standard',\n    synthesis_required: true\n  }\n};"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Crew Routing & Coordination Engine"
      }
    },
    {
      "id": "83e63ad0-6cb2-42d9-b107-82e369188b53",
      "name": "Observation Lounge Coordinator (Python)",
      "type": "mcp.execute",
      "originalType": "n8n-nodes-base.executeCommand",
      "position": [
        912,
        304
      ],
      "parameters": {
        "command": "python3"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Observation Lounge Coordinator (Python)"
      }
    },
    {
      "id": "a3a8f098-37ec-4adf-89d4-69b866f9b161",
      "name": "Observation Lounge Response Processor",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.code",
      "position": [
        1120,
        304
      ],
      "parameters": {
        "jsCode": "// Process Observation Lounge results and format for Cursor UI\nconst coordinatorOutput = $input.all()[0].json;\nconst sessionData = $input.all()[1].json;\n\n// Check if coordination was successful\nif (coordinatorOutput.error) {\n  return {\n    success: false,\n    error: coordinatorOutput.error,\n    session_id: sessionData.session_id,\n    timestamp: new Date().toISOString(),\n    ui_feedback: {\n      message: 'Observation Lounge session failed - please try again',\n      type: 'error',\n      show_retry: true\n    }\n  };\n}\n\n// Parse the coordinator output\nconst result = JSON.parse(coordinatorOutput.stdout || '{}');\n\nif (result.observation_lounge_session) {\n  // Enhanced Observation Lounge response\n  return {\n    success: true,\n    \n    // Session information\n    session: {\n      id: sessionData.session_id,\n      topic: sessionData.topic,\n      status: result.observation_lounge_session.session_status,\n      participants: result.observation_lounge_session.participants,\n      total_crew: result.observation_lounge_session.total_crew,\n      timestamp: result.observation_lounge_session.timestamp\n    },\n    \n    // Crew insights by department\n    crew_insights: result.crew_insights,\n    \n    // Synthesized discussion results\n    synthesis: result.synthesis,\n    \n    // Actionable outcomes\n    recommendations: result.recommendations || [],\n    next_actions: result.next_actions || [],\n    \n    // UI enhancement data for Cursor\n    ui_enhancements: {\n      // Visual representation of crew participation\n      crew_participation: {\n        total_crew: result.observation_lounge_session.total_crew,\n        active_participants: result.observation_lounge_session.participants,\n        participation_rate: (result.observation_lounge_session.participants / result.observation_lounge_session.total_crew * 100).toFixed(1) + '%',\n        status_icon: 'üöÄ'\n      },\n      \n      // Department insights summary\n      department_summary: Object.values(result.crew_insights || {})\n        .filter(insight => insight.status === 'success')\n        .map(insight => ({\n          department: insight.department,\n          crew_member: insight.crew_member,\n          confidence: insight.confidence,\n          status: 'active'\n        })),\n      \n      // Discussion quality metrics\n      discussion_quality: {\n        synthesis_available: !!result.synthesis,\n        recommendations_count: result.recommendations?.length || 0,\n        actions_count: result.next_actions?.length || 0,\n        quality_score: 'high'\n      }\n    },\n    \n    // Metadata\n    metadata: {\n      coordination_method: sessionData.coordination_method,\n      routing_strategy: sessionData.routing_strategy,\n      priority: sessionData.priority,\n      discussion_type: sessionData.discussion_type\n    }\n  };\n} else {\n  return {\n    success: false,\n    error: 'Invalid Observation Lounge response format',\n    session_id: sessionData.session_id,\n    timestamp: new Date().toISOString(),\n    ui_feedback: {\n      message: 'Observation Lounge response format error',\n      type: 'error',\n      show_retry: true\n    }\n  };\n}"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Observation Lounge Response Processor"
      }
    },
    {
      "id": "40b8a6ab-b636-428b-b823-92f4c0cd4fe9",
      "name": "Observation Lounge Response",
      "type": "mcp.response",
      "originalType": "n8n-nodes-base.respondToWebhook",
      "position": [
        1344,
        304
      ],
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {}
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Observation Lounge Response"
      }
    },
    {
      "id": "e4ba41e8-4a23-4d46-bda6-f027b0d37855",
      "name": "Observation Lounge Logging & Monitoring",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.code",
      "position": [
        1120,
        512
      ],
      "parameters": {
        "jsCode": "// Enhanced logging and monitoring for Observation Lounge sessions\nconst responseData = $input.all()[0].json;\nconst sessionData = $input.all()[1].json;\n\nif (responseData.success) {\n  const { session, crew_insights, synthesis } = responseData;\n  \n  console.log(`üöÄ Observation Lounge Session Success:`);\n  console.log(`   Session ID: ${session.id}`);\n  console.log(`   Topic: ${session.topic}`);\n  console.log(`   Participants: ${session.participants}/${session.total_crew}`);\n  console.log(`   Status: ${session.status}`);\n  console.log(`   Timestamp: ${session.timestamp}`);\n  \n  // Log crew participation by department\n  const departmentStats = {};\n  Object.values(crew_insights).forEach(insight => {\n    if (insight.status === 'success') {\n      const dept = insight.department;\n      if (!departmentStats[dept]) departmentStats[dept] = 0;\n      departmentStats[dept]++;\n    }\n  });\n  \n  console.log(`   Department Participation:`);\n  Object.entries(departmentStats).forEach(([dept, count]) => {\n    console.log(`     ${dept}: ${count} crew members`);\n  });\n  \n  // Log synthesis availability\n  if (synthesis) {\n    console.log(`   Synthesis: Available`);\n  } else {\n    console.log(`   Synthesis: Not available`);\n  }\n  \n} else {\n  console.error(`‚ùå Observation Lounge Session Failed: ${responseData.error}`);\n  console.error(`   Session ID: ${responseData.session_id}`);\n  console.error(`   Timestamp: ${responseData.timestamp}`);\n}\n\n// Pass through the data for potential further processing\nreturn responseData;"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Observation Lounge Logging & Monitoring"
      }
    },
    {
      "id": "87e7829c-81af-4694-8635-ac6a939a447a",
      "name": "Observation Lounge Status Updater",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.code",
      "position": [
        1344,
        512
      ],
      "parameters": {},
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Observation Lounge Status Updater"
      }
    }
  ],
  "edges": [
    {
      "id": "edge-observation-lounge-trigger-session-validator",
      "source": "observation-lounge-trigger",
      "target": "session-validator",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-session-validator-crew-routing-engine",
      "source": "session-validator",
      "target": "crew-routing-engine",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-crew-routing-engine-observation-lounge-coordinator",
      "source": "crew-routing-engine",
      "target": "observation-lounge-coordinator",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-observation-lounge-coordinator-observation-lounge-processor",
      "source": "observation-lounge-coordinator",
      "target": "observation-lounge-processor",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-observation-lounge-processor-observation-lounge-response",
      "source": "observation-lounge-processor",
      "target": "observation-lounge-response",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-observation-lounge-processor-observation-lounge-logging",
      "source": "observation-lounge-processor",
      "target": "observation-lounge-logging",
      "sourceHandle": "main-1",
      "targetHandle": "input"
    },
    {
      "id": "edge-observation-lounge-logging-observation-lounge-status-updater",
      "source": "observation-lounge-logging",
      "target": "observation-lounge-status-updater",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Observation Lounge Trigger-Session Validator & Coordinator",
      "source": "Observation Lounge Trigger",
      "target": "Session Validator & Coordinator",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Session Validator & Coordinator-Crew Routing & Coordination Engine",
      "source": "Session Validator & Coordinator",
      "target": "Crew Routing & Coordination Engine",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Crew Routing & Coordination Engine-Observation Lounge Coordinator (Python)",
      "source": "Crew Routing & Coordination Engine",
      "target": "Observation Lounge Coordinator (Python)",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Observation Lounge Coordinator (Python)-Observation Lounge Response Processor",
      "source": "Observation Lounge Coordinator (Python)",
      "target": "Observation Lounge Response Processor",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Observation Lounge Response Processor-Observation Lounge Logging & Monitoring",
      "source": "Observation Lounge Response Processor",
      "target": "Observation Lounge Logging & Monitoring",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Observation Lounge Logging & Monitoring-Observation Lounge Status Updater",
      "source": "Observation Lounge Logging & Monitoring",
      "target": "Observation Lounge Status Updater",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Observation Lounge Status Updater-Observation Lounge Response",
      "source": "Observation Lounge Status Updater",
      "target": "Observation Lounge Response",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    }
  ],
  "webhookExecutionPoints": [
    {
      "nodeId": "fa6bfef2-ec35-4667-94c1-eab105c24379",
      "nodeName": "Observation Lounge Trigger",
      "webhookPath": "observation-lounge",
      "webhookMethod": "POST",
      "mcpExecutionPath": "/api/workflows/execute?webhook=observation-lounge",
      "note": "‚ö†Ô∏è WEBHOOK EXECUTION POINT: This webhook can be executed via MCP at /api/workflows/execute with webhook path"
    }
  ],
  "metadata": {
    "originalWorkflowId": "vcuWBVUzAADZ8e5r",
    "convertedAt": "2025-11-21T14:24:04.686Z",
    "originalName": "COORDINATION - Observation Lounge - OpenRouter - Production"
  }
}