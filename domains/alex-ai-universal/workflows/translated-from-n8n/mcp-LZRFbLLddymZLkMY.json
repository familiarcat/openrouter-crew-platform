{
  "id": "mcp-LZRFbLLddymZLkMY",
  "name": "RAG Health Check (Auto-Remediation)",
  "description": "Converted from n8n workflow: RAG Health Check (Auto-Remediation)",
  "version": "1.0.0",
  "active": true,
  "nodes": [
    {
      "id": "4dcd890c-5120-42f1-8d01-37fc89ffca1f",
      "name": "Schedule Trigger",
      "type": "mcp.unknown",
      "originalType": "n8n-nodes-base.scheduleTrigger",
      "position": [
        250,
        300
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 5
            }
          ]
        }
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Schedule Trigger"
      }
    },
    {
      "id": "63c9f429-fc5b-402a-a76f-abe5495f25a0",
      "name": "Health Check Config",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.function",
      "position": [
        450,
        300
      ],
      "parameters": {
        "functionCode": "// Check health of all RAG components\nconst N8N_URL = 'https://n8n.pbradygeorgen.com';\n\nconst healthChecks = {\n  timestamp: new Date().toISOString(),\n  checks: [\n    {\n      name: 'knowledge_base_table',\n      type: 'supabase_table',\n      table: 'knowledge_base',\n      status: 'pending'\n    },\n    {\n      name: 'knowledge-ingest_webhook',\n      type: 'webhook',\n      url: `${N8N_URL}/webhook/knowledge-ingest`,\n      status: 'pending'\n    },\n    {\n      name: 'knowledge-query_webhook',\n      type: 'webhook',\n      url: `${N8N_URL}/webhook/knowledge-query`,\n      status: 'pending'\n    },\n    {\n      name: 'supabase_credential',\n      type: 'credential',\n      credential_id: 'GO5CVfyFiPo32qSk',\n      status: 'pending'\n    }\n  ]\n};\n\nconsole.log('üè• Running RAG health check...');\n\nreturn { json: healthChecks };"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Health Check Config"
      }
    },
    {
      "id": "93f0fe0a-2196-482b-bc09-6cb4b20348b7",
      "name": "Run Checks",
      "type": "mcp.transform",
      "originalType": "n8n-nodes-base.function",
      "position": [
        650,
        300
      ],
      "parameters": {
        "functionCode": "// Perform health checks and auto-remediate\nconst checks = $input.item.json.checks;\nconst results = [];\nlet failureCount = 0;\n\nfor (const check of checks) {\n  let status = 'healthy';\n  let message = 'OK';\n  let remediation = null;\n  \n  // For now, mark all as healthy (will be enhanced with actual API calls)\n  // Real implementation would ping each endpoint\n  \n  results.push({\n    ...check,\n    status: status,\n    message: message,\n    remediation: remediation,\n    checked_at: new Date().toISOString()\n  });\n}\n\nconsole.log(`üè• Health check complete: ${results.length - failureCount}/${results.length} healthy`);\n\nreturn {\n  json: {\n    overall_status: failureCount === 0 ? 'healthy' : 'degraded',\n    total_checks: results.length,\n    healthy_checks: results.length - failureCount,\n    failed_checks: failureCount,\n    checks: results,\n    timestamp: new Date().toISOString()\n  }\n};"
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Run Checks"
      }
    },
    {
      "id": "b5a3ee35-86d1-4b4b-91d2-caa0c9c33c9e",
      "name": "Log to Supabase",
      "type": "mcp.database",
      "originalType": "n8n-nodes-base.supabase",
      "position": [
        850,
        300
      ],
      "parameters": {
        "operation": "insert",
        "table": "rag_health_logs",
        "columns": "overall_status,total_checks,healthy_checks,failed_checks,checks,timestamp",
        "options": {}
      },
      "webhookInfo": null,
      "metadata": {
        "converted": true,
        "originalNode": "Log to Supabase"
      }
    }
  ],
  "edges": [
    {
      "id": "edge-Schedule Trigger-Health Check Config",
      "source": "Schedule Trigger",
      "target": "Health Check Config",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Health Check Config-Run Checks",
      "source": "Health Check Config",
      "target": "Run Checks",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    },
    {
      "id": "edge-Run Checks-Log to Supabase",
      "source": "Run Checks",
      "target": "Log to Supabase",
      "sourceHandle": "main-0",
      "targetHandle": "input"
    }
  ],
  "webhookExecutionPoints": [],
  "metadata": {
    "originalWorkflowId": "LZRFbLLddymZLkMY",
    "convertedAt": "2025-11-21T14:24:04.673Z",
    "originalName": "RAG Health Check (Auto-Remediation)"
  }
}